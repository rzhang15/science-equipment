# Load necessary libraries
library(tidyverse)
library(fixest)
library(haven)
library(MatchIt)
library(cobalt)
library(Synth)
library(ggplot2)
isid <- function(data, ...) {
# Get the column names provided as input
cols <- enquos(...)
# Group by the input columns and check uniqueness
duplicates <- data %>%
group_by(!!!cols) %>%
summarise(row_count = n(), .groups = "drop") %>%
filter(row_count > 1)
# Return result
if (nrow(duplicates) == 0) {
message("The combination of columns uniquely identifies rows.")
return(TRUE)
} else {
message("The combination of columns does NOT uniquely identify rows.")
print(duplicates)
return(FALSE)
}
}
# Load data
panel <- read_dta("../external/dallas/mkt_panel.dta")
# Load data
panel <- read_dta("../external/dallas/mkt_yr.dta")
View(panel)
# Load data
panel <- read_dta("../external/dallas/sku_yr.dta")
View(panel)
treated <- panel %>% filter(treated==1)
control <-panel %>% filter(treated==0)
View(control)
treated_pre <- treated %>%
filter(year <= 2013) %>%
select(
mkt,
year,
treated,
price,
qty,
spend,
raw_price,
raw_qty,
raw_spend
)
control_pre <- control %>%
filter(year <= 2013) %>%
select(
mkt,
year,
treated,
price,
qty,
spend,
raw_price,
raw_qty,
raw_spend
)
all_data_pre <- bind_rows(treated_pre, control_pre)
summary(all_data_pre$year)
missing_years <- all_data_pre %>%
group_by(product_grp) %>%
reframe(missing_year = setdiff(2011:2013, unique(year)))
missing_years <- all_data_pre %>%
group_by(sku) %>%
reframe(missing_year = setdiff(2011:2013, unique(year)))
View(all_data_pre)
treated_pre <- treated %>%
filter(year <= 2013) %>%
select(
sku,
mkt,
year,
treated,
price,
qty,
spend,
raw_price,
raw_qty,
raw_spend
)
control_pre <- control %>%
filter(year <= 2013) %>%
select(
sku,
mkt,
year,
treated,
price,
qty,
spend,
raw_price,
raw_qty,
raw_spend
)
all_data_pre <- bind_rows(treated_pre, control_pre)
all_data_pre <- bind_rows(treated_pre, control_pre) %>%
group_by(mkt) %>%
filter(n_distinct(treated) == 2) %>%
ungroup()
View(all_data_pre)
# Load necessary libraries
library(tidyverse)
library(fixest)
library(haven)
library(MatchIt)
library(cobalt)
library(Synth)
library(ggplot2)
isid <- function(data, ...) {
# Get the column names provided as input
cols <- enquos(...)
# Group by the input columns and check uniqueness
duplicates <- data %>%
group_by(!!!cols) %>%
summarise(row_count = n(), .groups = "drop") %>%
filter(row_count > 1)
# Return result
if (nrow(duplicates) == 0) {
message("The combination of columns uniquely identifies rows.")
return(TRUE)
} else {
message("The combination of columns does NOT uniquely identify rows.")
print(duplicates)
return(FALSE)
}
}
# Load data
panel <- read_dta("../external/dallas/sku_yr.dta")
treated <- panel %>% filter(treated==1)
control <-panel %>% filter(treated==0)
treated_pre <- treated %>%
filter(year <= 2013) %>%
select(
sku,
mkt,
year,
treated,
price,
qty,
spend,
raw_price,
raw_qty,
raw_spend
)
control_pre <- control %>%
filter(year <= 2013) %>%
select(
sku,
mkt,
year,
treated,
price,
qty,
spend,
raw_price,
raw_qty,
raw_spend
)
all_data_pre <- bind_rows(treated_pre, control_pre) %>%
group_by(mkt) %>%
filter(n_distinct(treated) == 2) %>%
ungroup()
View(all_data_pre)
all_data_pre <- bind_rows(treated_pre, control_pre) %>%
group_by(sku) %>%
filter(n() >= 2) %>%
ungroup() %>%
group_by(mkt) %>%
filter(n_distinct(treated) == 2) %>%
ungroup()
View(all_data_pre)
